name: Build
on:
  workflow_dispatch:
  push:
    branches:
      - '**'
jobs:
  build:
    uses: bmw-tech-talent-days/bmw.cloudadoption.workflows/.github/workflows/java-build.yaml@main
    with:
      ACR_REPOSITORY: "vehicle-order-service-java"
      DOCKERFILE_PATH: src/main/docker/Dockerfile.jvm
      JAVA_VERSION: '11'
      MAVEN_VERSION: "3.8.2"
    secrets:
      AZURE_ACR_PASSWORD: ${{ secrets.AZURE_ACR_PASSWORD }}
      TTD_GITHUB_TOKEN: ${{ secrets.TTD_GITHUB_TOKEN }}



# name: Build

# on:
#   push:
#     branches:
#       - '**'

#   workflow_dispatch: {}

# jobs:
#   build:
#     runs-on: ubuntu-latest
#     env:
#       MAVEN_VERSION: 3.8.2

#     steps:
#       - name: Checkout
#         uses: actions/checkout@v3

#       - name: JDK 11 setup
#         uses: actions/setup-java@v2
#         with:
#           java-version: '11'
#           distribution: 'zulu'

#       - name: Maven setup
#         uses: stCarolas/setup-maven@v4.3
#         with:
#           maven-version: ${{ env.MAVEN_VERSION }}

#       - name: Maven build
#         run: |
#           mvn clean install -DskipTests

#       - name: Configure AWS credentials
#         uses: aws-actions/configure-aws-credentials@v2
#         with:
#           aws-access-key-id: ${{ secrets.AWS_ACCESS_KEY_ID }}
#           aws-secret-access-key: ${{ secrets.AWS_SECRET_ACCESS_KEY }}
#           aws-region: eu-west-1
          
#       - name: Login to Amazon ECR
#         id: login-ecr
#         uses: aws-actions/amazon-ecr-login@v1

#       - name: Build, tag, and push image
#         env:
#           REGISTRY: ${{ steps.login-ecr.outputs.registry }}
#           REPOSITORY: vehiclemockorder-java
#         run: |
#           docker build -t $REGISTRY/$REPOSITORY:latest -f src/main/docker/Dockerfile.jvm .
#           docker push $REGISTRY/$REPOSITORY:latest
